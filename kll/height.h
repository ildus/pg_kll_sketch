#include <math.h>

static double heights_cache[] = {
	1,
	0.6666666666666666,
	0.4444444444444444,
	0.2962962962962963,
	0.19753086419753085,
	0.1316872427983539,
	0.0877914951989026,
	0.05852766346593506,
	0.039018442310623375,
	0.026012294873748915,
	0.01734152991583261,
	0.011561019943888407,
	0.007707346629258938,
	0.005138231086172625,
	0.00342548739078175,
	0.0022836582605211663,
	0.0015224388403474443,
	0.0010149592268982961,
	0.0006766394845988641,
	0.00045109298973257606,
	0.0003007286598217174,
	0.00020048577321447823,
	0.0001336571821429855,
	8.910478809532365e-05,
	5.9403192063549106e-05,
	3.960212804236607e-05,
	2.640141869491071e-05,
	1.760094579660714e-05,
	1.1733963864404761e-05,
	7.82264257626984e-06,
	5.21509505084656e-06,
	3.4767300338977064e-06,
	2.3178200225984708e-06,
	1.5452133483989804e-06,
	1.030142232265987e-06,
	6.867614881773246e-07,
	4.5784099211821645e-07,
	3.0522732807881095e-07,
	2.0348488538587396e-07,
	1.356565902572493e-07,
	9.04377268381662e-08,
	6.02918178921108e-08,
	4.019454526140719e-08,
	2.67963635076048e-08,
	1.78642423384032e-08,
	1.1909494892268798e-08,
	7.939663261512532e-09,
	5.293108841008354e-09,
	3.528739227338903e-09,
	2.352492818225935e-09,
	1.5683285454839568e-09,
	1.0455523636559712e-09,
	6.970349091039809e-10,
	4.646899394026538e-10,
	3.097932929351026e-10,
	2.0652886195673503e-10,
	1.3768590797115669e-10,
	9.179060531410445e-11,
	6.119373687606963e-11,
	4.0795824584046424e-11,
	2.7197216389364282e-11,
	1.813147759290952e-11,
	1.2087651728606347e-11,
	8.058434485737563e-12,
	5.372289657158376e-12,
	3.581526438105584e-12,
	2.3876842920703892e-12,
	1.5917895280469262e-12,
	1.0611930186979508e-12,
	7.074620124653005e-13,
	4.716413416435336e-13,
	3.1442756109568906e-13,
	2.0961837406379272e-13,
	1.3974558270919513e-13,
	9.316372180613009e-14,
	6.21091478707534e-14,
	4.140609858050226e-14,
	2.760406572033484e-14,
	1.8402710480223226e-14,
	1.226847365348215e-14,
	8.178982435654766e-15,
	5.452654957103177e-15,
	3.635103304735452e-15,
	2.423402203156968e-15,
	1.615601468771312e-15,
	1.0770676458475411e-15,
	7.180450972316942e-16,
	4.786967314877961e-16,
	3.191311543251974e-16,
	2.1275410288346492e-16,
	1.418360685889766e-16,
	9.455737905931773e-17,
	6.303825270621183e-17,
	4.2025501804141215e-17,
	2.801700120276081e-17,
	1.8678000801840538e-17,
	1.2452000534560357e-17,
	8.301333689706904e-18,
	5.534222459804603e-18,
	3.6894816398697355e-18,
	2.459654426579824e-18,
	1.6397696177198825e-18,
	1.0931797451465883e-18,
	7.287864967643922e-19,
	4.858576645095947e-19,
	3.239051096730632e-19,
	2.1593673978204208e-19,
	1.439578265213614e-19,
	9.597188434757427e-20,
	6.398125623171617e-20,
	4.2654170821144116e-20,
	2.843611388076274e-20,
	1.8957409253841826e-20,
	1.263827283589455e-20,
	8.4255152239297e-21,
	5.6170101492864665e-21,
	3.744673432857645e-21,
	2.4964489552384296e-21,
	1.6642993034922866e-21,
	1.1095328689948576e-21,
	7.39688579329905e-22,
	4.931257195532699e-22,
	3.2875047970218e-22,
	2.1916698646812e-22,
	1.4611132431208001e-22,
	9.740754954138666e-23,
	6.493836636092445e-23,
	4.3292244240616286e-23,
};

static double
compute_height(size_t h)
{
	if (h < (sizeof(heights_cache) / sizeof(double)))
	{
		return heights_cache[h];
	}
	return pow((2.0 / 3.0), (double) h);
}
